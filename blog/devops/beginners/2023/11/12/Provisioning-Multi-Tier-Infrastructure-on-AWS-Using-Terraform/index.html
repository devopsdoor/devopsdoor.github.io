<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Step-by-Step Guide. Provisioning Multi-Tier Infrastructure on AWS Using Terraform (Mac OS) &#8211; DevOpsDoor Blog</title>
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link rel="dns-prefetch" href="//fonts.gstatic.com">
    <link rel="dns-prefetch" href="//maxcdn.bootstrapcdn.com">
    <link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="A Blog By DevOps Door.">
    <link rel="manifest" type="application/manifest+json; charset=utf-8" href="/blog/manifest.json" />
    <meta name="robots" content="all">
    <meta name="author" content="Basil Varghese">
    
    <meta name="keywords" content="DevOps, Beginners">
    <link rel="canonical" href="http://devopsdoor.com/blog/devops/beginners/2023/11/12/Provisioning-Multi-Tier-Infrastructure-on-AWS-Using-Terraform/">
    <link rel="alternate" type="application/rss+xml" title="RSS Feed for DevOpsDoor Blog" href="/blog/feed.xml" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/blog/css/pixyll.css?202312111649" type="text/css">

    <!-- Fonts -->
    
    <link href='//fonts.googleapis.com/css?family=Merriweather:900,900italic,300,300italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Lato:900,300' rel='stylesheet' type='text/css'>
    
    

    <!-- MathJax -->
    

    <!-- Verifications -->
    
    

    <!-- Open Graph -->
    <!-- From: https://github.com/mmistakes/hpstr-jekyll-theme/blob/master/_includes/head.html -->
    <meta property="og:locale" content="en_US">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Step-by-Step Guide. Provisioning Multi-Tier Infrastructure on AWS Using Terraform (Mac OS)">
    <meta property="og:description" content="A Blog By DevOps Door.">
    <meta property="og:url" content="http://devopsdoor.com/devops/beginners/2023/11/12/Provisioning-Multi-Tier-Infrastructure-on-AWS-Using-Terraform/">
    <meta property="og:site_name" content="DevOpsDoor Blog">
    

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary" />
    
    <meta name="twitter:title" content="Step-by-Step Guide. Provisioning Multi-Tier Infrastructure on AWS Using Terraform (Mac OS)" />
    <meta name="twitter:description" content="A Blog By DevOps Door." />
    <meta name="twitter:url" content="http://devopsdoor.com/devops/beginners/2023/11/12/Provisioning-Multi-Tier-Infrastructure-on-AWS-Using-Terraform/" />
    

    <!-- Icons -->
    <link rel="apple-touch-icon" sizes="57x57" href="/blog/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/blog/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/blog/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/blog/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/blog/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/blog/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/blog/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/blog/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/blog/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="/blog/favicon-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/blog/favicon-160x160.png" sizes="160x160">
    <link rel="icon" type="image/png" href="/blog/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/blog/favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="/blog/favicon-32x32.png" sizes="32x32">
    <link rel="shortcut icon" href="/blog/favicon.ico">

    
</head>

<body class="site">
  
	

  <div class="site-wrap">
    <header class="site-header px2 px-responsive">
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-P6MMB5LW8T"></script>
  <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-P6MMB5LW8T');
  </script>
  <div class="mt2 wrap">
    <div class="measure">
      <a href="/blog/" class="site-title">DevOpsDoor Blog</a>
      <nav class="site-nav">
        



    
    
    
    
        <a class="nav-link" href="/blog/about/">About DevOpsDoor</a>
    

    

    
    
    
    
        <a class="nav-link" href="/blog/contact/">Contact Us</a>
    

    


      </nav>
      <div class="clearfix"></div>
      
    </div>
  </div>
</header>


    <div class="post p2 p-responsive wrap" role="main">
      <div class="measure">
        


<div class="post-header mb2">
  <h1>Step-by-Step Guide. Provisioning Multi-Tier Infrastructure on AWS Using Terraform (Mac OS)</h1>
  <span class="post-meta">Nov 12, 2023</span><br>
  
  <span class="post-meta small">
  
    6 minute read
  
  </span>
</div>

<article class="post-content">
  <p>In the world of DevOps, managing infrastructure efficiently is crucial. Infrastructure as Code (IaC) tools like Terraform streamline this process by allowing the provisioning of complex architectures on cloud platforms like AWS. In this tutorial, we’ll walk through using Terraform to create a multi-tier infrastructure for hosting a sample web app on AWS, all from your Mac OS.</p>

<h2 id="prerequisites">Prerequisites</h2>

<p>Before diving in, ensure you have the following:</p>
<ul>
  <li>An AWS account</li>
  <li>Terraform installed on your Mac OS</li>
  <li>Basic knowledge of AWS services and Terraform</li>
</ul>

<h2 id="step-1-set-up-aws-credentials">Step 1: Set Up AWS Credentials</h2>

<p>Before you start using Terraform to provision resources on AWS, you need to set up your AWS credentials on your Mac OS. Follow these steps:</p>

<h3 id="create-access-key-and-secret-key">Create Access Key and Secret Key</h3>

<ol>
  <li>
    <p><strong>Log in to the AWS Management Console.</strong></p>
  </li>
  <li><strong>Navigate to IAM (Identity and Access Management).</strong>
    <ul>
      <li>Go to the <a href="https://console.aws.amazon.com/iam/">IAM Dashboard</a> in your AWS Management Console.</li>
    </ul>
  </li>
  <li><strong>Access Users and Add a New User.</strong>
    <ul>
      <li>From the left-hand side panel, click on “Users.”</li>
      <li>Click on the “Add user” button.</li>
    </ul>
  </li>
  <li><strong>Set User Details.</strong>
    <ul>
      <li>Enter a username (e.g., <code class="language-plaintext highlighter-rouge">terraform-user</code>) for the new IAM user.</li>
      <li>Click Next.</li>
    </ul>
  </li>
  <li><strong>Define User Permissions.</strong>
    <ul>
      <li>Select “Attach policies directly” and Attach policies to grant necessary permissions. For this tutorial, you can attach the <code class="language-plaintext highlighter-rouge">AmazonEC2FullAccess</code> and <code class="language-plaintext highlighter-rouge">AmazonVPCFullAccess</code> policies to the user for managing EC2 and VPC resources.</li>
    </ul>
  </li>
  <li><strong>Review and Create the User.</strong>
    <ul>
      <li>Review the user details and permissions.</li>
      <li>Click “Create user.”</li>
    </ul>
  </li>
  <li><strong>Get Access Key ID and Secret Access Key.</strong>
    <ul>
      <li>After the user is created, you’ll be prompted to download the user’s credentials (Access Key ID and Secret Access Key) as a CSV file. Ensure you save this file securely.</li>
      <li>If you were not prompted to download credentials, click on the username you created (eg: terraform-user) &gt; Security Credentials &gt; “Create Access Key” &gt; Select “Command Line Interface (CLI)” &gt; Click Next &gt; Create Access Key &gt; Download .csv file &gt; Done</li>
    </ul>
  </li>
</ol>

<h3 id="configure-aws-cli-with-access-key-and-secret-key">Configure AWS CLI with Access Key and Secret Key</h3>

<p>Once you have the Access Key ID and Secret Access Key:</p>

<ol>
  <li><strong>Install AWS CLI if not already installed.</strong>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brew install awscli
</code></pre></div>    </div>
  </li>
  <li><strong>Configure AWS CLI with your credentials.</strong>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>aws configure
</code></pre></div>    </div>
    <ul>
      <li>Enter your Access Key ID and Secret Access Key when prompted.</li>
      <li>Set the default region and output format as needed.</li>
    </ul>

    <p>By following these steps, you’ll create an IAM user, generate access keys, and configure the AWS CLI on your Mac OS to enable Terraform to authenticate and interact with your AWS account.</p>
  </li>
</ol>

<h2 id="step-2-install-terraform-on-mac-os">Step 2: Install Terraform on Mac OS</h2>

<p>Download and install Terraform on your Mac OS using Homebrew.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Install Terraform via Homebrew
brew install terraform
</code></pre></div></div>

<h2 id="step-3-create-terraform-configuration-files">Step 3: Create Terraform Configuration Files</h2>

<p>Organize your Terraform files for deploying the multi-tier infrastructure. Here’s a basic file structure:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>project-folder/
│
├── main.tf         # Main Terraform configuration
├── variables.tf    # Variables file
└── backend.tf      # Backend configuration (optional)
</code></pre></div></div>

<h2 id="step-4-define-infrastructure-components">Step 4: Define Infrastructure Components</h2>

<h3 id="create-a-vpc-virtual-private-cloud">Create a VPC (Virtual Private Cloud)</h3>
<p>To create a VPC using Terraform, define the VPC resource in your <code class="language-plaintext highlighter-rouge">main.tf</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># main.tf
# Create VPC

resource "aws_vpc" "my_vpc" {
  cidr_block = "10.0.0.0/16"
  tags = {
    Name = "my-vpc"
  }
}

# Create an Internet Gateway
resource "aws_internet_gateway" "my_igw" {
  vpc_id = aws_vpc.my_vpc.id

  tags = {
    Name = "my-internet-gateway"
  }
}
</code></pre></div></div>

<h3 id="define-subnets">Define Subnets</h3>
<p>Next, create subnets within the VPC. Append below lines to the above code:</p>

<p><em>NOTE: Modify the availability zones us-west-1a and us-west-1b with the desired values.</em></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># main.tf

resource "aws_subnet" "public_subnet" {
  vpc_id     = aws_vpc.my_vpc.id
  cidr_block = "10.0.1.0/24"
  availability_zone = "us-west-1a"
  map_public_ip_on_launch = true
  tags = {
    Name = "public-subnet"
  }
}

resource "aws_subnet" "private_subnet" {
  vpc_id     = aws_vpc.my_vpc.id
  cidr_block = "10.0.2.0/24"
  availability_zone = "us-west-1b"
  tags = {
    Name = "private-subnet"
  }
}
</code></pre></div></div>

<h3 id="create-security-groups">Create Security Groups</h3>

<p>Define security groups to control inbound and outbound traffic. Append below lines to your code:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># main.tf

resource "aws_security_group" "web_sg" {
  name        = "web-sg"
  description = "Security group for web tier"
  vpc_id      = aws_vpc.my_vpc.id

  # Define ingress and egress rules as needed
  # Example:
  ingress {
    from_port   = 80
    to_port     = 80
    protocol    = "tcp"
    cidr_blocks = ["0.0.0.0/0"]
  }
}

# Define security groups for other tiers (app, database) similarly
</code></pre></div></div>

<h3 id="launch-ec2-instances-web-tier">Launch EC2 Instances (Web Tier)</h3>

<p>Create EC2 instances for each tier. Append below lines to your code:</p>

<p><em>NOTE: Modify the ami “ami-0287a05f0ef0e9d9a” with your desired ami.</em></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># main.tf

resource "aws_instance" "web_server" {
  ami           = "ami-0287a05f0ef0e9d9a"  # Specify your desired AMI
  instance_type = "t2.micro"
  subnet_id     = aws_subnet.public_subnet.id
  security_groups = [aws_security_group.web_sg.id]

  # Add user data to install Nginx and serve a sample page
  user_data = &lt;&lt;-EOF
              #!/bin/bash
              yum update -y
              yum install nginx -y
              echo "&lt;h1&gt;Welcome to my web server!&lt;/h1&gt;" &gt; /usr/share/nginx/html/index.html
              service nginx start
              EOF
}

</code></pre></div></div>

<h3 id="set-up-load-balancers">Set Up Load Balancers</h3>

<p>Define load balancers to distribute incoming traffic. Append below lines to your code:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># main.tf

resource "aws_lb" "my_lb" {
  name               = "my-load-balancer"
  internal           = false
  load_balancer_type = "application"
  subnets            = [aws_subnet.public_subnet.id]

  enable_deletion_protection = false

  # Add listeners, target groups, and other configurations as needed
}
</code></pre></div></div>

<p><strong>Explanation</strong></p>

<p><strong>VPC:</strong> Defines the Virtual Private Cloud network with a specified CIDR block.</p>

<p><strong>Subnets:</strong> Creates public and private subnets within the VPC across different availability zones.</p>

<p><strong>Security Groups:</strong> Defines rules to control inbound and outbound traffic for different tiers (e.g., web, app, database).</p>

<p><strong>EC2 Instances:</strong> Launches an EC2 instance for the web tier, installs Nginx, and serves a sample webpage.</p>

<p><strong>Load Balancers:</strong> Sets up a load balancer to distribute traffic among EC2 instances.</p>

<p>By following these steps and running Terraform, you’ll create a multi-tier infrastructure on AWS, complete with VPC, subnets, security groups, EC2 instances, and a load balancer, ready to serve a sample web page using Nginx.</p>

<h2 id="step-5-define-variables-optional">Step 5: Define Variables (Optional)</h2>

<p>Utilize the <code class="language-plaintext highlighter-rouge">variables.tf</code> file to declare variables for the infrastructure components to ensure flexibility and reusability.</p>

<h2 id="step-6-initialize-terraform-and-plan-deployment">Step 6: Initialize Terraform and Plan Deployment</h2>

<p>Initialize the Terraform configuration and check the plan before applying changes.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Initialize Terraform in your project directory
terraform init

# Check the execution plan
terraform plan
</code></pre></div></div>

<h2 id="step-7-apply-changes">Step 7: Apply Changes</h2>

<p>Apply the Terraform changes to create the infrastructure on AWS.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Apply changes to provision infrastructure
terraform apply
</code></pre></div></div>

<h2 id="step-8-test-the-infrastructure">Step 8: Test the Infrastructure</h2>

<p>After successful deployment, test the infrastructure:</p>

<ul>
  <li>Access deployed resources (e.g., web app)</li>
  <li>Perform basic functionality tests</li>
</ul>

<p><strong>Conclusion</strong></p>

<p>Congratulations! You’ve successfully provisioned a multi-tier infrastructure on AWS using Terraform on your Mac OS. This tutorial provides a foundation for DevOps enthusiasts seeking hands-on experience with infrastructure as code.</p>

<p>Expand upon this setup, experiment with different AWS services, or enhance your Terraform skills to further optimize your infrastructure deployment process.</p>

<p>Happy coding and automating with Terraform!</p>

<hr />

<p><a href="https://devopsdoor.com">DevOps Door</a> is here to support your DevOps learning journey. Join our DevOps training programs to gain hands-on experience and expert guidance. Let’s unlock the potential of seamless software development together!</p>

</article>











      </div>
    </div>
  </div>

  <footer class="center">
  <div class="measure">
    <small>
      DevOps Door.
    </small>
  </div>
</footer>

<script type="text/javascript">
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("/blog/sw.js")
    }
</script>

</body>
</html>
